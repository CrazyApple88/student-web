/*! plug-1.0.0.js 2018-02-03 10:11:30 */

function CommonPage(t){if(this.options=$.extend({url:"",flag:!0,pageBtnDiv:null,pageBtnClass:"pageBtnStyle",limit:10,totalpageflag:!0,skipflag:!0,setlimitpage:!0,data:{pageNo:1,pageSize:10,totalPages:0},beforLoadData:function(){},afterLoadData:function(){}},t),this.options.setlimitpage){var a=$("#limitpagenum").val();void 0!=a&&"undefined"!=a&&(this.options.data.pageSize=a)}return this.listData=null,this.init(),this}CommonPage.prototype.init=function(){this.loadData()},CommonPage.prototype.getQueryParameter=function(){return this.options.data},CommonPage.prototype.setPageNo=function(t){return this.setParameter("pageNo",t)},CommonPage.prototype.setPageSize=function(t){return this.setParameter("pageSize",t)},CommonPage.prototype.setTotalPages=function(t){return this.setParameter("totalPages",t)},CommonPage.prototype.setPageCount=function(t){return this.setParameter("pageCount",t)},CommonPage.prototype.setParameter=function(t,a){return this.options.data[t]=a},CommonPage.prototype.loadData=function(t){var a,e=this;e.options.beforLoadData&&e.options.beforLoadData.apply(this,[]),$.ajax({url:e.options.url,dataType:"json",type:"post",async:!1,data:e.getQueryParameter(),success:function(o){"1"==o.code&&(o=o.data,e.setPageNo(o.pageNo),e.setPageSize(o.pageSize),e.setTotalPages(o.pageTotal),e.setPageCount(o.pageCount),e.options.callBack&&e.options.callBack.apply(this,[o.result]),t&&t.apply(this,[o.result])),e.options.afterLoadData&&e.options.afterLoadData.apply(this,[a]),e.options.pageBtnDiv&&e.initPageButton(),e.options.flag=!0,e.listData=o.result},error:function(){a="error",e.options.afterLoadData&&e.options.afterLoadData.apply(this,[a])}})},CommonPage.prototype.nextPage=function(){var t=this;if(++t.options.data.pageNo>t.options.data.totalPages)return!1;t.loadData()},CommonPage.prototype.gotopage=function(t){var a=this;if(t>a.options.data.totalPages)return!1;a.setPageNo(t),a.loadData()},CommonPage.prototype.gotoskip=function(t){var a=this;if(t>a.options.data.totalPages)return!1;a.setPageNo(t),a.loadData()},CommonPage.prototype.limitpage=function(t){var a=this,e=$("#limitpagenum option:selected").val();a.setPageSize(e),a.setPageNo(t),a.loadData()},CommonPage.prototype.initPageButton=function(){var t=this;if(t.options.pageBtnDiv){$(t.options.pageBtnDiv).empty(),$(t.options.pageBtnDiv).siblings(".fontpage").remove(),$(t.options.pageBtnDiv).siblings(".skipcont").remove(),$(t.options.pageBtnDiv).siblings(".limitpagenum").remove(),$(t.options.pageBtnDiv).hasClass(t.options.pageBtnClass)||$(t.options.pageBtnDiv).addClass(t.options.pageBtnClass);var a=t.options.data.pageNo,e=t.options.data.totalPages,o=t.options.data.pageCount,i=t.options.limit%2==0?t.options.limit/2:(t.options.limit+1)/2,p=e>0?e:1;a+i>t.options.limit&&a<=e?p=i+a<=e?i+a:e:a<t.options.limit&&e>t.options.limit&&(p=t.options.limit);var n=t.options.limit-1;p<=n&&(n=p-1);var s=UDP.Public.getmessage("page.pageMessage.homepage","首页"),g=UDP.Public.getmessage("page.pageMessage.trailerpage","尾页"),l=UDP.Public.getmessage("page.pageMessage.skip","跳转");if(t.options.totalpageflag){void 0!==a&&void 0!==o||(a=1,o=0);var r=UDP.Public.getmessage("page.pageMessage.currentpage","当前第 "+a+" 页 / 总共 "+o+" 条",[a,o]);$(t.options.pageBtnDiv).before($("<span class='fontpage'>"+r+"</span>"))}if(this.options.setlimitpage){var m="<select class='limitpagenum' id='limitpagenum'>";10==t.options.data.pageSize?m+="<option value='10' selected='selected' >10</option>":m+="<option value='10'>10</option>",20==t.options.data.pageSize?m+="<option value='20' selected='selected' >20</option>":m+="<option value='20'>20</option>",30==t.options.data.pageSize?m+="<option value='30' selected='selected' >30</option>":m+="<option value='30'>30</option>",50==t.options.data.pageSize?m+="<option value='50' selected='selected' >50</option>":m+="<option value='50'>50</option>",100==t.options.data.pageSize?m+="<option value='100' selected='selected' >100</option>":m+="<option value='100'>100</option>",m+="</select>";var u=$(m);$(this.options.pageBtnDiv).before(u)}else{m="<input type='hidden' id='limitpagenum' value='10'>";$(this.options.pageBtnDiv).before(m)}this.options.skipflag&&$(this.options.pageBtnDiv).before($("<div class='skipcont'><input type='text' class='skippage'/><input type='submit' class='skipBtn' id='skipBtn' value='"+l+"'/> </div>")),$(t.options.pageBtnDiv).append($("<span class='pageNum pageFirLat pageFirst' page-data='1'>"+s+"</span>"));var d=1;a>1&&(d=a-1),$(t.options.pageBtnDiv).append($("<span class='pageNum' page-data='"+d+"'><i class='bgPreNex'>«</i></span>"));for(var c=p-n;c<=p;c++)c==a?$(t.options.pageBtnDiv).append($("<span class='pageNum active' page-data='"+c+"'>"+c+"</span>")):$(t.options.pageBtnDiv).append($("<span class='pageNum' page-data='"+c+"'>"+c+"</span>"));var v=a+1;v>e&&(v=p),$(t.options.pageBtnDiv).append($("<span class='pageNum' page-data='"+v+"'><i class='bgPreNex'>»</i></span>")),$(t.options.pageBtnDiv).append($("<span class='pageNum pageFirLat pageLast' page-data='"+e+"'>"+g+"</span>")),$(t.options.pageBtnDiv).find("span").on("click",function(){var a=$(this).attr("page-data");t.gotopage(a)}),t.options.skipflag&&$("#skipBtn").on("click",function(){var a=$(".skipcont .skippage").val();if(!/^[1-9]\d*$/g.test(a))throw"格式不正确!";t.gotoskip(a)}),t.options.setlimitpage&&$("#limitpagenum").change(function(){t.limitpage()})}},function(t){t.UDP?t.UDP.CommonPage=CommonPage:t.UDP={CommonPage:CommonPage};t.UDP.Public.PlugList({fileType:"plug",filename:"page"})}(window);